\documentclass{article} \usepackage[utf8]{inputenc}
\usepackage{xstring}
\usepackage{calc, xintexpr}
\usepackage{xfp}
\usepackage{pdftexcmds}
\usepackage{coolstr}
\usepackage{intcalc}
\usepackage{amsrefs}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{listings}
\usepackage[most]{tcolorbox}
\usepackage{lipsum}

% input hardcoded
\def\hardcodedinputa{12222222202122221222022002212220222202201222222222222202202212222222021000022222222222211222222222202222222222222222222222222202202222222222222222222202222222222022220212022112222221222212220222222222}
\def\hardcodedinputb{22220222222222222222100102222222222222022222222220222222222222222222222222220222222222222222222222220222222222222222120212212222222122222220022222222222220220220222222212010002222222222222022222222221}
\def\hardcodedinputc{22222222222222222222222222122222222222222222222222122222222122222202022220222022222222122102222222222222122222222222220202202222222222222012222222222222222222222222222222222222222122222222222222222222}
\def\hardcodedinputd{22222222222222222212222202200221222222200222222222222212202212222222121020022222222222212222222222202222222222222222222222222202202222222222222222122202222222222212221212122022212220222212202222222222}
\def\hardcodedinpute{22221220222222222212222122222222222222022222022220222222222220222222222222222221222222222222222222222222222222222222221212222221022222222222122222222222222220220222212212012122222222222221222022122221}
\def\hardcodedinputf{22222222222022222222222222122222222222222222222222122222222222222222122222222222202222022122222222222222122222022220220211010222222222222202212202222122222222222022222222222222022022222222222222220222}
\def\hardcodedinputg{12222222202022222202022202210220222212221222222222222222212202222021122021022222222222220222221222212222222222202222222222222222202222222222222222122212222222212212221202122112221221222202200222222222}
\def\hardcodedinputh{22222220220222222122020202222222222221222222122021222222222221222122222222221222222222222222222222222222222221211222120202210221122022220221222222222222220220221222202022212202222222222220122022122222}
\def\hardcodedinputi{22222222222022222222222222222122222222222222221222222222222222122202220221022102222222222012222222222222222120122222202200210222222222222222222202212022222222222122202222222222222222222022222222220222}
\def\hardcodedinputj{22222222222022220202022022212222222222210222222222222212212202222021022012222222222222001221222222222222222222222222222222222222212222202222222222122202222222212222222212022122200020222222222220222222}
\def\hardcodedinputba{22222220211222212022000112222222222220022022022122222222222221222022222222220221222220222222222202221222222220222222020202211222012022220221122122222222220220200222212012100212222222222200022022022120}
\def\hardcodedinputbb{22222222222122202222222222122022222022222222222222022222222022222202221221022111202202222122222222222222122221122221221210200222222222222002222222212122222222222022212222222222122222222222222222220222}
\def\hardcodedinputbc{12222222202012222212222222210221221212221220222222222212202002222120122012022222222222020222221220222222222222202221222222222222212222212222222222022202222222202102222222122102211220220212220221222222}
\def\hardcodedinputbd{22221220201222202022210102222222222211222122122221222222222222222222222222221222222222222222222212221222222222210222022222222220222222121221122222222222220220222222202102212202222222022200022222122221}
\def\hardcodedinputbe{22222222222122222222222222022222222122222222220222222222222220222202121220022122222212122122202222222222122222222221202201022222222222221222202222222122222222222222212222222222122222222022222122222222}
\def\hardcodedinputbf{22222222222122220212122002201022220202211222222222222212202112222221121122122222220222220222220222212222222222202222222222222212202222212222222222022212222222222022022212022122201222222222220220222222}
\def\hardcodedinputbg{22222222210222202012112222222222122200122022222120222222222222222022222222220222222221222222222212220222222222221202120222200220002022220221222122222222220220220222212222002102222222122212122022122222}
\def\hardcodedinputbh{22222222222122212222222222022122222022222022221222122222222020022222120221022121112222122102212222222222222021022220212202011222222202220012202202212222222222222222212022222222022022222222222022222222}
\def\hardcodedinputbi{02222222222002020212122002211202220202202222222222222222222102222021021011022222222222010220220222222222222222202221202222222212202222222222212222022002222222222102121212122002212222221222211220222222}
\def\hardcodedinputbj{22221221212222222112002102222222222210022122122020222222222220222122222202222222222221222220222212220222222221222202122212202220102221221221222022222222222221211222212122201002222222222201222022122122}
\def\hardcodedinputca{22222222222122222122202222021222222122222022222221022222222222021222120222122112002202122022212222222220022222222220212202222222222212220012212212222122222222222022222122220222022222222122222222220221}
\def\hardcodedinputcb{22222222212022121222122122222121202222221222222222222122222022222220121210012222220222102220222220202222222222212222202222022212002222212222222222122202222022212222021222222022221100210222201220222222}
\def\hardcodedinputcc{22210221221222202212021221222222022222222122122220222221222221222021222112220202222220222220222212212222222221211202220222222221010021220222222122222222222221200222202122111120222222222221122122122121}
\def\hardcodedinputcd{22222022222122222222210222121022222122222122222220122220212222121202021222212202212122222102222222222220022221122221212220211122222212221022212202212022222122222022202022200222020222222222222122221221}
\def\hardcodedinputce{12222022212202122212022201220011210212221221222222222112202212222122022212122222222222022222221220212222222222212220212221122222212222202222222222122202222021212122021202022120222001202222222220222222}
\def\hardcodedinputcf{22210222220222202212021022222222222222222222222121222221222222222220022112221211222222222222222212222222202222211202122202221222122020120220222222222222221222202222202002211012220222022211222022022020}
\def\hardcodedinputcg{22222022222222212212201222120022222022222122222220222221212022021202221222002001112012122212202222222222222122122220201200122122022212221222222202202222222222222122212222200222022022222022222022220222}
\def\hardcodedinputch{22222021202222020212122021220120202202211222222222222212202112222222120222012212220222011221221222212222222222202220202222222212012222202222222222122202222222202112120222122012220121202212222222222222}
\def\hardcodedinputci{22201221200222222212110011222222122222222122122021222220222221222020122202221212222221222221222202210222222021221202021202210021202022121220222022222222201222210222212212122220220222022200022122022122}
\def\hardcodedinputcj{22222222222222222212200222122122222022222122221221022221202022221202022222112000112102222222202222222222022022222222210202212222122212220012222222212222222222222022222212222222222022222222222022220220}
\def\hardcodedinputda{02222021212122021202222110211122200222211220222222222222222202222022121101212222222222100220220222212222222222202220220222122222212222222222222222122002222221202112220222222000201120202222210222222222}
\def\hardcodedinputdb{22201220200222212002010102222222222221222022022020222222222222222221222212220201222220222222222212021222222120220202021212221121021121220222122222222222200220201222222112210112222222222210122222222221}
\def\hardcodedinputdc{22222222222222202112212222022022222022222122222220022122202220122102022220012012122112022122222222222221222022022220220201211221122202222222212202212122222022222222222122200222120222222022222122222200}
\def\hardcodedinputdd{12212220222212101212222120201021220212212220222222222222212210222222020212102102222222111220222220202222200222212221210221022212122222202222212222122022202022212202212212022021220200202222222220222222}
\def\hardcodedinputde{22222221201022212222122100200222222222022022022222222221122220222021222112220210222222222221222202201221222122202201222202212021101220120222122122222222212221222222202122022220221222222100222022122021}
\def\hardcodedinputdf{22222022222022212122210222022022222122222222222210022120202020021122121220222222022002122022212222222221122122002222222220111220122212202102222202222122222012222022202112201202020122222022222022221221}
\def\hardcodedinputdg{02212020222112000212122122212200222212211220222222222202222201222120221022202012222221220220222222212222201222212220201222021222222222202222222222121122202220222012222212122200212121220222210221222222}
\def\hardcodedinputdh{22220221211222212112011002211222222112122222122121222221222221222222222012020201222221222220222202200222222021222201021212221222102022121222022022222222221222200022222102111000201222122002122122222020}
\def\hardcodedinputdi{22222122222222212102200222021022222222222022221211022220222022000022022222112102102022022122212222222222022222222220201211222020222222222112202222202122222122222222202022211202022222222022222122221210}
\def\hardcodedinputdj{22212120202200121222222010222222221212210221222222222122212020222220020012002112221222210221220220222222210222202221202221020222002220202222212222120122012022202222020202022210220210210212201222222222}
\def\hardcodedinputea{22210222211022212002121001211222222020222122222121222220022221222221222202021222222221222222222222212210222121220122220212220021201021122221122222221222201222200222222022111022202222022211022122222122}
\def\hardcodedinputeb{22222102221122222112221222021222212122222022222221121022212222221022220221102020222002222122222222122222022020012221200210110020122212221002212212212222222202221222202022212212120122212021222122221220}
\def\hardcodedinputec{22112021202202211222222122211221201212222222222222222212202120222020021202202022222221212220222220212222212222102222200221220212002220212222212222221212012220202120102222022110222012200202201022222212}
\def\hardcodedinputed{22211222211122212222220201220222022102222022222120222220022222222122022112021202221021222222222212020220202121220112221212210020111021122220122122222222221220200122222002122220200222122222022122022220}
\def\hardcodedinputee{22222122220022202202222202120222012120222122221210022020222120211012022222002001212102022102202222122222022121122221210210121022222202222102202202202222222200220122202122200212021021122021222222220200}
\def\hardcodedinputef{22122120222100121202022211211000212222212022222222222202222221222122222020112102222220220222220222222022212222112221220220120222002100222222212222120112220022222222012202222122210220221202221221222200}
\def\hardcodedinputeg{22212222211222222002020120221022122000122022222122212222012211222220122212120221210021212222222202211210202120211102021212220222221022220222202122200022212222212022212222211121211122020122222122022021}
\def\hardcodedinputeh{22222222222022212202220202022122112020222122221221021111212122211112221221002021122222122210212220022221122121102222211222121020122202212112222212222022222012221022222200201212020122022221222122221220}
\def\hardcodedinputei{12220220202120111212122111220001211202211122212201222112212001222122222211012012221211122220221220212022221122112220202021222222102112202022222222020002011221212112100222022110212202221222220120222012}
\def\hardcodedinputej{22201222212222222012222222210222120021222122222020212221122210222220012002021202211120212221222212111222222021220101220202221222110022120221022021221122222221200222202212111202212022122001022222122022}
\def\hardcodedinputfa{20222200220122202112210222122120102020222022220222221002222121011202120221022220222022122200212222002222122221212221222211101021012222201012222212202022222122220222202100220222222122122021222122220202}
\def\hardcodedinputfb{02221220212200011202222020220122212112222221222000222212212011022020021102212112222200022221221222222122201022022222212020122202212122212222202222122022102021202020222222022121211012221022200121202121}
\def\hardcodedinputfc{22220221222112222102120102201122122100122222222202222221212222222122022022221212202220212221222222122221022121221111222212201221122021220222112020220222201222211122222112202210221122120000122102222200}
\def\hardcodedinputfd{20222100220222000212201212121121020021222222220212121112202202121222120220112211002002222022202221222220222222211222112222010221122212022102201212221022222101221022222211212202121221012120222022221220}
\def\hardcodedinputfe{02201220222212202212221020201122221102200122220200222212222122222110120102112000222221212220020222112022202022222210102120022222002012222022212222220212212020210120102212220011202202220122211122201112}
\def\hardcodedinputff{22202222211102202222100012210022022010222002122102212220202210221222202002022211211011212220222202200220011020020021020222221021012022120222022022211122200222220202202112011210200122222022122212022220}
\def\hardcodedinputfg{21222201220222121201210222020121021221222122220221120122122222201102122212122002012112122012212020222220122220221221201201222101202212202202211212222022222112220222202201212202221022002122222122221202}
\def\hardcodedinputfh{10001111210220021202020210210221212102212120200002222112212101222200222000000201120200111221122221102122210222212211010122122202002010222222202222221212001100211202112202121022222221211022212122201012}
\def\hardcodedinputfi{22221220222022202112120200102012220101122012022221222220202200222210012102122220212110222222222222110100022121222221121212211021100121200222012021022122211221222122200202122010011202220110022210222101}
\def\hardcodedinputfj{21222220221022220021222202220220112122222022221222010222202102010102222200212011122210221212222222002220122022110222220200212220002222202022221222202021222022221122112121221222020021002121222222222222}
\def\hardcodedinputga{20211020210211212202020012200011200012212221221120222022202121222120021022022101022222200220221222012122212222222210002021122102122121102222222222122211210100220222221222020012200212220022210020211122}
\def\hardcodedinputgb{22202221200202220202001210100012222011122022022002212222122210222102122122221222220221212220222221101010211021120020120222020222020020100201022022210222201220222012212102120020112122221221222012222202}
\def\hardcodedinputgc{21120012222122012220210202021220010020222022221110212210202021220202220202112002122220121221222212012220222121102221202212101201102202011112200022222021022220221122002211221222021021110021222222220201}
\def\hardcodedinputgd{21112011200201101212220110202102222202010021202211222102012221222002122120110202222212120222010220202012100222200211012122022122202212202222222222212121111222212222000222021200212120222112002220222202}
\def\hardcodedinputge{22220220212212211122022121121112220102122120022012222202022201020102211022101202211012222222222211020020120121200221221202102022222120221222102222002122221212201122222202020212012122222012222112022202}
\def\hardcodedinputgf{21122221221122212202010222020120120122222022221100220212102100001002021212002111112001120212222122012220122021012221001211210222221202220212222122202020022121220002000112102201220021101120222222221101}
\def\hardcodedinputgg{01120002212112121202021011220100201222222121200210212012102002022100021022101101222221012222222220002222111122121202021000022202212021202122202222020211201020200001202222021220200020221212100121221201}
\def\hardcodedinputgh{22212200202222202212021112220100020221122221222111210202112222222001011112220201211200222222222201110010112120200000122202020220221120112211020020201222210221221112221002000210110102221001022121122212}
\def\hardcodedinputgi{21222112220122111111211200020100221120222222221001212110112201002102002222222211022220020121222122012120011220022221200201101011211122112102211222202221122202222002200210222200021000211122222112220011}
\def\hardcodedinputgj{00010111200012200210220202200122210222100110212212202102202020022111221000020202112211122220202220002120000120102200211010021212201112112022201222001002200212202221002211121021220200200110221210212102}
\def\hardcodedinputha{20211112212002200222012101210101221102222212122120210101022221020022202212101221101201202221022221111221001122022111120211200121221022120112111221020222200022202212211202112111012002120021022201122212}
\def\hardcodedinputhb{22020220201122011020012221220101002020222122220100221011122120000212101002102100122110000110012200002221021122022220221201020000211112112112212222210120000000201102200210110212221101210022222202220020}
\def\hardcodedinputhc{11200202202102212202101022212122212002110122202220202012022102222011222220112112212201022222210222022121120021000221120101220202211221202012200222022010011220212200210212201012221002220010001122210121}
\def\hardcodedinputhd{22202110201112202222220011221201022212122212222101220120202021220201010012111202001001200222022212220112122022200002020010020020222020221100212201112021212221221222202012122002102201120022122120122100}
\def\hardcodedinputhe{21002200212012111002001200121202200221022212221022000111200112220201120010120220220210222111022200001200222202210000100020021010101220200010122011000210212201122101121221121120101211021010101201000111}
\def\hardcodedinput{\hardcodedinputa\hardcodedinputb\hardcodedinputc\hardcodedinputd\hardcodedinpute\hardcodedinputf\hardcodedinputg\hardcodedinputh\hardcodedinputi\hardcodedinputj\hardcodedinputba\hardcodedinputbb\hardcodedinputbc\hardcodedinputbd\hardcodedinputbe\hardcodedinputbf\hardcodedinputbg\hardcodedinputbh\hardcodedinputbi\hardcodedinputbj\hardcodedinputca\hardcodedinputcb\hardcodedinputcc\hardcodedinputcd\hardcodedinputce\hardcodedinputcf\hardcodedinputcg\hardcodedinputch\hardcodedinputci\hardcodedinputcj\hardcodedinputda\hardcodedinputdb\hardcodedinputdc\hardcodedinputdd\hardcodedinputde\hardcodedinputdf\hardcodedinputdg\hardcodedinputdh\hardcodedinputdi\hardcodedinputdj\hardcodedinputea\hardcodedinputeb\hardcodedinputec\hardcodedinputed\hardcodedinputee\hardcodedinputef\hardcodedinputeg\hardcodedinputeh\hardcodedinputei\hardcodedinputej\hardcodedinputfa\hardcodedinputfb\hardcodedinputfc\hardcodedinputfd\hardcodedinputfe\hardcodedinputff\hardcodedinputfg\hardcodedinputfh\hardcodedinputfi\hardcodedinputfj\hardcodedinputga\hardcodedinputgb\hardcodedinputgc\hardcodedinputgd\hardcodedinputge\hardcodedinputgf\hardcodedinputgg\hardcodedinputgh\hardcodedinputgi\hardcodedinputgj\hardcodedinputha\hardcodedinputhb\hardcodedinputhc\hardcodedinputhd\hardcodedinputhe}

% https://tug.org/tug2019/slides/slides-ziegenhagen-python.pdf
\usepackage{fancyvrb}
\makeatletter
\newenvironment{pycode}[1]%
{\xdef\d@tn@me{#1}\xdef\r@ncmd{python #1.py > #1.plog}%
\typeout{Writing file #1}\VerbatimOut{#1.py}%
}
{\endVerbatimOut %
\toks0{\immediate\write18}%
\expandafter\toks\expandafter1\expandafter{\r@ncmd}%
 \edef\d@r@ncmd{\the\toks0{\the\toks1}}\d@r@ncmd %
 \noindent Input
 \inputminted{python}{\d@tn@me.py}%
 \noindent Output
 \inputminted{text}{\d@tn@me.plog}%
 }
 \makeatother


% quote backgrounds: https://tex.stackexchange.com/a/436253/102826
\definecolor{linequote}{RGB}{224,215,188}
\definecolor{backquote}{RGB}{249,245,233}

\newtcolorbox{myquote}{%
    enhanced, breakable, 
    size=fbox,
    frame hidden, boxrule=0pt,
    sharp corners,
    colback=backquote,
    borderline horizontal={.5pt}{0pt}{linequote},
    borderline horizontal={.5pt}{1pt}{linequote}
}

%% Important!!
%% Use ! before "O{}" with xparse 2018-05-12 
%% See: https://tex.stackexchange.com/q/434928/1952
\NewTCBListing{mycode}{ !O{} }{%
    enhanced, breakable, 
    size=fbox,
    frame hidden, boxrule=0pt,
    sharp corners,
    colback=gray!30,
    listing only, 
    listing options={%
        style=tcblatex,
        keywordstyle=\color{brown!70!black},
        texcsstyle=*\color{brown!70!black}
    },
    #1}


% TeX docs at http://pgfplots.sourceforge.net/TeX-programming-notes.pdf

% TODO: https://tex.stackexchange.com/questions/29402/how-do-i-make-my-document-look-like-it-was-written-by-a-cthulhu-worshipping-madm
% cool hack: http://texhacks.blogspot.com/2010/12/forcing-full-expansion.html

\newif\ifcomputationenabled
\computationenabledtrue
\newif\ifdebug
\debugtrue

\title{Advent of Code\\
{\large Day Eight}}
\author{LucidBrot} \date{August 2020}
\input{input.tex}

% https://tex.stackexchange.com/a/7183/102826
% if is num, emphasize, else ignore.
\def\isnum#1{%
  \if!\ifnum9<1#1!\else_\fi
    \emph{#1}\else#1\fi}


\newcommand{\firstchar}[1]{%
    \StrLeft{#1}{1}[\firstletter]%
    \firstletter
}

% documentation: \getchar[hello]{5}   is 'h'
\def\getchar[#1]#2{%
\StrMid{#1}{#2}{\numexpr #2 + 0\relax}[\mychar]%
\mychar}

% same as getchar but maybe it works when used in string comparison?
\def\getcoolchar[#1]#2{%
\substr{#1}{#2}{1}%
}
% NOPE! It's just as broken, just in a different way. it works as long as the first argument is a string. but if it's a command... then it returns the whole thing as first character.

% https://tex.stackexchange.com/questions/195491/ifthenelse-equal-string-comparison-fails
\makeatletter
\newcommand\strcmptozero[1]{%
  \ifnum\pdf@strcmp{\unexpanded{#1}}{0}=0 %
     \expandafter\@firstoftwo
  \else
    \expandafter\@secondoftwo
  \fi
    {TRUE}
    {FALSE}%
}
\makeatother

% modulo computation in plain TeX
% https://tex.stackexchange.com/a/34434/102826
\newcount\tmpcnta
\def\modulo#1#2{\tmpcnta=#1
        \divide\tmpcnta by #2
        \multiply\tmpcnta by #2
        \multiply\tmpcnta by -1
        \advance\tmpcnta by #1\relax
        \the\tmpcnta}

\begin{document}


\maketitle

\section{About}
The task at \href{https://adventofcode.com/2019/day/8}{adventofcode 2019 day 8} is fairly straightforward itself. It can be summarized as \begin{myquote}\begin{quote}
Read the input line of $N$ numeric characters into \textit{layers} of size $width * height$ (which are known) to find the layer that contains the lowest number of zeros. Then return the number of \texttt{'1'} digits multiplied by the number of \texttt{'2'} digits within that layer.
\end{quote}\end{myquote}

However, we're doing this in \LaTeX , which is typeset in spongebob-case for a reason.

\section{The \LaTeX\,\.E\.x\.p\.e\.r\.i\.e\.n\.c\.e}
First of all, we're doing something that it was not meant to be used for -- so that means we never get the search results we want. Searching about arrays in \LaTeX for example gives you an explanation about how to typeset matrices. Very useful, but not what I wanted. Thankfully, the \href{http://pgfplots.sourceforge.net/TeX-programming-notes.pdf}{pgfplots sourceforge page} contains a pdf with \textit{Notes On Programming in \TeX}.

Secondly, there don't seem to be any variables. Just \textit{counters}, \textit{counts} which are the \TeX version. and \textit{ifdefs} and most importantly \textit{macros}. But I did not read up on the internals of \TeX and \LaTeX, so I have no clue about the exact way that macros are evaluated. Sometimes you can define a command that works perfectly well for a constant argument, but if you dare use it on the result of another command, you're being had from multiple directions. Because that result has not already been evaluated (expanded) and is passed as-is into the other command. My version of pdfLaTex does not feature the primitive \texttt{\textbackslash expanded} yet. Using \texttt{\textbackslash expandafter} feels very clunky. Luckily there's a hack around that to be found \href{http://texhacks.blogspot.com/2010/12/forcing-full-expansion.html}{here}. And sometimes the problem was actually the \texttt{xstring} package which also breaks the hack.

\begin{samepage}
\begin{myquote}
\begin{quote}
The macros of this package are not purely expandable, i.e. they cannot be put in the argument of an \textbackslash edef. Nestling macros is not possible neither.

For this reason, all the macros returning a result (i.e. all excepted the tests) have an optional argument in last position. The syntax is \texttt{[ name ]}, where name is the name of the control sequence that will receive the result of the macro: the assignment is made with an \textbackslash edef which make the result of the macro name purely expandable. Of course, if an optional argument is present, the macro does not display anything.\citelist{\cite{Gonzalo}}
\end{quote}
\end{myquote}
\end{samepage}

After eliminating some problems of this sort by storing the result in a new command by virtue of the optional argument, the same problem still appeared because some commands just don't work due to the same issue, even if they are making use of the optional argument to return that in turn \hbox{(See Figure \ref{code:1}, Figure \ref{fig:diff}).}

\begin{figure}[hbtp]
\begin{lstlisting}[language=TeX]
\def\getchar[#1]#2{%
\StrMid{#1}{#2}{\numexpr #2 + 0\relax}[\mychar]%
\mychar}
\end{lstlisting}
\caption{This command does not like to be used on a non-constant string.}
\label{code:1}
\end{figure}

\begin{figure}[hbt]
\makebox[\textwidth][c]{\includegraphics[width=1.6\textwidth]{diff}}%
  \caption{The difference between wrong code that compiles (red) and seemingly correct code that produces a compiler error (green).}
  \label{fig:diff}
\end{figure}

Finally, the performance of the \texttt{xstring} package is whack. It takes more than two minutes to figure out the length of a 15'000 character string. The bash command \texttt{wc -c inputfile.txt} does that in less than a second.
\clearpage
\section{StrLen}
Since \texttt{xstring}'s \texttt{StrLen} is so slow, how about creating a faster one?
We'll just have to run tex with the \texttt{--shell-escape} flag.\citelist{\cite{shellescape}}. Using that allows us to escape to the shell - which is either bash or the windows cmd.exe.

%\immediate\write18{wc -c inputfile.tex > scriptoutput.tex}
%Character Count: \input{scriptoutput.tex}
A simple \texttt{\textbackslash input\{|"echo test"\}} already works!
\input{|"echo test!"}

But I cannot figure out how to correctly call \texttt{wc -c inputfile.tex} because the shell spawns in the wrong path. And also, for some reason the following code does not even create a file \texttt{outfile.blubb} anywhere on my machine.
\begin{lstlisting}
\input{|"echo a > outfile.blubb"}
\end{lstlisting}
The problem seems to be, according to the logs, that the pipe closes before the left side is finished writing to stdout. But that is actually happening due to the \texttt{echo} earlier. When I leave it out, that's not logged.

Maybe using python is easier? You'd have to read the source to get this one though.\citelist{\cite{pythonescape}}
\begin{lstlisting}
\begin{pycode}{abc}
print(1+12)
\end{pycode}
\end{lstlisting}
But no, that also results in a problem with writing to a file... So let me try something I understand!
\begin{mycode}
\input{|"python -c "print(1+2);""}
\end{mycode}
\typeout{trying python}
\input{|"python -c "print(1+2);""}
\newline
And as you should be able to see, it works!

So for computing stringlength, a quick python call should speed things up.
\begin{mycode}
\input{|"python -c "print(len('mystringofunkownlength'));""}
\end{mycode}
\input{|"python -c "print(len('mystringofunkownlength'));""}
\newline
It is notable that spaces within that string get lost before they are passed to python. Thankfully we don't need this here. But this reminds my of \href{https://ctftime.org/writeup/21982}{PyAuCalc}.

We can make \LaTeX\, paste a string into that as well...

\begin{mycode}
\def\mystr{hello}
\def\mystrtwo{\mystr}
\input{|"python -c "print(len('\mystrtwo'));""}
\end{mycode}
\def\mystr{hello}
\def\mystrtwo{\mystr}
\input{|"python -c "print(len('\mystrtwo'));""}
...but for some reason it fails when used with our included inputstring. There's a site with an example on how to include text from a file, but it does not work at all for me\citelist{\cite{stackexpand}}. I guess I'll just hardcode it inside this file here instead...

\makeatletter
\def\einput#1{\@@input #1 \space}
\newcommand{\showexpanded}[1]{%
  \everyeof{\expandafter\@gobble\noexpand}%
  \long\edef\@tempcontents{#1}%
  \show\@tempcontents
}
\newcommand{\justexpanded}[1]{%
  \everyeof{\expandafter\@gobble\noexpand}%
  \long\edef\@tempcontents{#1}%
  \@tempcontents
}
\makeatother
\def\testingfile{\einput{testing.tex}}
%\showexpanded{\testingfile}
%\justexpanded{\testingfile}
%\input{|"python -c "print(len('\justexpanded{\testingfile}'));""}
\hardcodedinput

\section{Execution}

We had \Strawberries\ Strawberries for this year's harvest. Probably not enough.
So we are sad now and solve https://adventofcode.com/2019/day/8.

% get first character of string hello
\getchar[hello]{1}
\getcoolchar[hello]{2}
%\firstchar{\include{inputfile}}

% compute integer arithmetic
\inteval{3 - 2}

% compute integer arithmetic
% "Although \relax does nothing by itself, it is a safe command to stop expansion of another command"
\newcommand\three{3}
\the\numexpr \three - 2 + 5 \relax
% and to store it in a variable???? redirection and then reusing \three does not work. We need a new variable.
\def\tmp{\three}
\def\four{\the\numexpr \tmp - 2 + 5 }

\newcommand\threehundred{300}

% include the input file
\ifdebug
  \def\inputstring{\input{debuginputfile.tex}}
\else
  \def\inputstring{\input{inputfile.tex}}
\fi
% and print it
\inputstring

% include the input file in a different way because the previous way fails when passed as argument to getchar
\ifdebug
\newread\file
\openin\file=debuginputfile.tex
\read\file to \fileline
\closein\file
\else
\newread\file
\openin\file=inputfile.tex
\read\file to \fileline
\closein\file
\fi

hello world 
% get second character of inputfile
\getchar[\three]{1}
\getcoolchar[300]{1}
\getcoolchar[\threehundred]{1}
\typeout{===>"three"|\three}

% Variables given by the task


% variables given by the task:
\newcount{\imgwidth}
\imgwidth=25
\newcount{\imgheight}
\imgheight=6
\ifdebug
\imgwidth=3
\imgheight=2
\fi

Image Width: \the\imgwidth \hspace{1cm}Image Height: \the\imgheight

% compute size of a layer
\newcount{\layersize}
\layersize=\the\imgwidth
\multiply\layersize by \imgheight \relax
\typeout{Size of a layer is \the\layersize}
I want to loop \the\layersize~times for the first layer.

% store the index of the best layer. The best layer has the fewest digits. So initialize the counter to maximum possible + 1.
\newcount\bestlayer
\bestlayer=-1
\newcount\bestlayerzerocount
\bestlayerzerocount=\inteval{\layersize + 1}
\global\newcount\currentlayerzerocount
\newcount\currentlayer

% now for the first layer count the number of zeros
\currentlayer=0
\currentlayerzerocount=0
\global\newcount\digitctr
\digitctr=0 % count from 1, not from zero. So we count from 1 to \layersize because we start advancing at the start of the loop.
% TODO: optimize getting current char by deleting from string.
%
\newcount\layerafterthelast

\StrLen{\fileline}[\stahp]%find the strlen and store it in \stahp
% see https://tex.stackexchange.com/a/15424/102826
\def\stahpnow{\the\numexpr \stahp - 1}

The input file contains \stahpnow characters.
%flag condition to skip long computation for debugging layout
\ifcomputationenabled


% optimization because xstring library is slow.
% We remove the head of the input string once it has been used. This happens every time the layer has been read.
\def\workingline{\fileline}

% Aand now repeat the inner loop below once per layer. 

\loop
	{\loop
	  \message{\the\digitctr}
	  \global \advance \digitctr by1
	  % assign current char. Because of optimization, we need to do some math
             \def\accessor{\the\numexpr \intcalcMod{\digitctr}{\layersize} + 1 \relax}
\typeout{Accessor is \accessor}
             \StrMid{\workingline}{ \accessor}{\accessor}[\currentchar]

	  % check if zero
            \IfEq {0}{\currentchar}{
	    \global \advance \currentlayerzerocount by1
	    Advanced currentlayerzerocount to \the\currentlayerzerocount~for layer \the\currentlayer.
	    % if the zerocount is not optimal, abort early
	    \ifnum \currentlayerzerocount<\inteval{\bestlayerzerocount}
	      % continue as normal
                \message{Everything is fine with digitcounter \the\digitctr}
	    \else
	      % abort and check next layer
	      % for this we set the counter to the first character index of the next layer
	      \global\digitctr={\the\numexpr \layersize * \currentlayer + \layersize}
	      \message{Digitcounter reset to \the\digitctr}
	Layer \the\currentlayer has more zeros than the current best layer (\the\bestlayer ) so we skip ahead to character at index \the\digitctr to start the next layer.\\
	    \fi
             }{%else
                The current char \currentchar~does not equal 0.\\
                \typeout{Msg from IFEQ ELSE branch}
	 }%fi
	\ifnum \digitctr<\inteval{\layersize * \currentlayer + \layersize}
	\repeat
         }%
\message{Finished inner loop}
	% if there were very little zeros, we can update the best layer
	\ifnum \currentlayerzerocount<\bestlayerzerocount
	  \bestlayer=\currentlayer
	  \bestlayerzerocount=\currentlayerzerocount
             Found a new best layer (\the\bestlayer) with zerocount \the\bestlayerzerocount.\\
\message{Found a new best layer \the\bestlayer}
          \else
             Current Layer (\the\currentlayer) with zerocount \the\currentlayerzerocount~is worse than Best Layer (\the\bestlayer, zerocount \the\bestlayerzerocount).\\
\message{Layer \the\currentlayer is not a new best layer.}
	\fi
          Best Layer Zero Count is \the\bestlayerzerocount~for layer \the\bestlayer. \\

          % truncate inputstring
          \StrGobbleLeft{\workingline}{\layersize}[\workingline]

\ifnum \digitctr<\stahpnow
	\currentlayerzerocount=0
	\advance \currentlayer by1
	Advanced currentlayer to \the\currentlayer.\\
\repeat
The current layer is now \the\currentlayer
% end of flag condition to skip long computation for debugging layout
\fi



\begin{bibdiv}
\begin{biblist}
%\bib{Bourbaki70}{book}{
%title={Theorie des ensembles},
%author={Bourbaki, Nicolas},
%date={1970},
%publisher={Hermann},
%address={Paris}
%}
%\bib{Sokal96}{article}{
%title={Trangressing the boundaries},
%subtitle={Toward a transformative hermeneutics of quantum gravity},
%author={Sokal, Alan},
%journal={Social Text},
%volume={46/47},
%date={1996},
%pages={217--252}
%}
\bib{Gonzalo}{webpage}{
title={Nest StrLen and ifthenelse commands},
author={Medina, Gonzalo},
url={https://tex.stackexchange.com/a/15424/102826},
accessdate={05.08.2020}
}
\bib{shellescape}{webpage}{
title={texify.exe in TeXworks in MSWindows 10: MiKTex encountered internal error when compile with --shell-escape},
author={Desyllas, Dimitrios},
url={https://tex.stackexchange.com/a/437933/1028266},
accessdate={05.08.2020}
}
\bib{pythonescape}{webpage}{
title={Combining \LaTeX with Python},
author={Ziegenhagen, Uwe},
url={https://tug.org/tug2019/slides/slides-ziegenhagen-python.pdf},
date={09.08.2019},
accessdate={05.08.2020}
}
\bib{stackexpand}{webpage}{
title={Why is everyeof needed to avoid...},
author={Gross, Jason},
url={https://tex.stackexchange.com/q/516031/102826},
accessdate={07.08.2020}
}
\end{biblist}
\end{bibdiv}


\end{document}